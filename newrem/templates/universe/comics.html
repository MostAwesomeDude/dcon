{% extends "universe/base.html" %}
{% import "macros.html" as macros %}
{% import "oc/macros.html" as ocmacros %}

{% block title %}{{ super() }} - {{ comic.title }}{% endblock %}

{% block head %}
    {{ super() }}
    <link rel="stylesheet"
        href="{{ url_for("static", filename="oc.css") }}" />
{% endblock %}

{% block content %}
    {{ macros.render_comic(u, comic, comics) }}
    {{ macros.render_nav(u, chrono, characters) }}
    <div id="discussion">
        {% if ocform is defined %}
            {{ ocmacros.render_form(ocform, url_for("comment", u=u, cid=comic.id), "co") }}
        {% endif %}
        {{ render_posts(comic.thread) }}
    </div>
{% endblock %}

{% macro render_posts(thread) %}
    <section id="threads">
        {% for post in thread.posts %}
        <article>
            <header>
                {{ post.author }} <time>{{ post.timestamp }}</time> No. {{ post.id }} <br />
            </header>
            <section>
                {% if post.filename %}
                    <img src="{{ post.url() }}" />
                {% endif %}
                {{ post.comment|eblogify|safe }}
            </section>
        </article>
        <br />
        {% endfor %}
    </section>
{% endmacro %}
